<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>amgilp - Toplist - Are my games in lichess puzzles ?</title>    
</head>
<body>
	<div id="root">
		Loading toplist ...
	</div>
</body>
<script>
	const records = xxx.split("\n").filter(record => record.length > 0)
	
	let page = 1
	const pageM = document.location.href.match(/toplistPage=([0-9]+)/)
	if(pageM) page = parseInt(pageM[1])
	
	const prevPage = page > 1 ? `<a href="/?toplistPage=${page - 1}">Previous page</a> | ` : ""
	
	document.getElementById("root").innerHTML = `${prevPage}<a href="/?toplistPage=${page + 1}">Next page</a> | <a href="/">Home</a><hr>
`	
	document.write(`<table cellspacing="3" cellpadding="3" border="1">`)
	document.write(`<tr><td>Index</td><td>Rank</td><td>Username</td><td>No</td><td>Puzzles</td></tr>`)
	
	for(let i in records){
		const record = records[i]
		const [rank, username, num, puzzleIdsStr] = record.split(",")
		
		const puzzleUrls = puzzleIdsStr.split(" ").map(puzzleId => `<a target="_blank" rel="noopener noreferrer" href="https://lichess.org/training/${puzzleId}">${puzzleId}</a>`).join(" | ")
		
		document.write(`<tr id="tr${parseInt(i) + 1}"><td><a href="/?toplistPage=${page}#${parseInt(i) + 1}">${parseInt(i) + records.length * (page - 1) + 1}.</a></td><td>${rank}.</td><td><a target="_blank" rel="noopener noreferrer" href="https://lichess.org/@/${username}">${username}</a></td><td>${num}</td><td><div style="max-height:50px; overflow:scroll;">${puzzleUrls}<div></td></tr>`)
	}
	document.write(`</table>`)
	
	setTimeout(_ => {
		let indexM = document.location.href.match(/#([0-9]+)$/)
		if(indexM){
			const id = `tr${indexM[1]}`
			console.log(id)
			document.getElementById(id).scrollIntoView()
		}	
	}, 1000)
	
</script>
</html>
